sens = c(sensitivity.df[1,1], sensitivity.df[1,2], sensitivity.df[1,3], sensitivity.df[1,4], sensitivity.df[1,5])
method = c("LR", "CT", "KNN", "Ensemble", "Ensemble.prob")
both.df = data.frame(method, "accuracy"= acc, "sensitivity"=sens)
both.df$sum = both.df$accuracy + both.df$sensitivity
ggplot(data = both.df, aes(x = method, fill = accuracy + sensitivity)) + geom_bar(position="stack") + ggtitle("Methods overall comparison") + geom_text(aes(label = round(accuracy + sensitivity,4)), stat = "count", colour = "grey38", size = 3, vjust = -0.3)
acc = c(accuracy.df[1,1], accuracy.df[1,2], accuracy.df[1,3], accuracy.df[1,4], accuracy.df[1,5])
sens = c(sensitivity.df[1,1], sensitivity.df[1,2], sensitivity.df[1,3], sensitivity.df[1,4], sensitivity.df[1,5])
method = c("LR", "CT", "KNN", "Ensemble", "Ensemble.prob")
both.df = data.frame(method, "accuracy"= acc, "sensitivity"=sens)
both.df$sum = both.df$accuracy + both.df$sensitivity
ggplot(data = both.df, aes(x = method, fill = accuracy + sensitivity)) + geom_bar(position="stack") + ggtitle("Methods overall comparison") + geom_text(aes(label = round(accuracy + sensitivity,4)), stat = accuracy + sensitivity, colour = "grey38", size = 3, vjust = -0.3)
acc = c(accuracy.df[1,1], accuracy.df[1,2], accuracy.df[1,3], accuracy.df[1,4], accuracy.df[1,5])
sens = c(sensitivity.df[1,1], sensitivity.df[1,2], sensitivity.df[1,3], sensitivity.df[1,4], sensitivity.df[1,5])
method = c("LR", "CT", "KNN", "Ensemble", "Ensemble.prob")
both.df = data.frame(method, "accuracy"= acc, "sensitivity"=sens)
both.df$sum = both.df$accuracy + both.df$sensitivity
ggplot(data = both.df, aes(x = method, fill = accuracy + sensitivity)) + geom_bar(position="stack") + ggtitle("Methods overall comparison") + geom_text(aes(label = round(accuracy + sensitivity,4)), stat = both.df$accuracy + both.df$sensitivity, colour = "grey38", size = 3, vjust = -0.3)
acc = c(accuracy.df[1,1], accuracy.df[1,2], accuracy.df[1,3], accuracy.df[1,4], accuracy.df[1,5])
sens = c(sensitivity.df[1,1], sensitivity.df[1,2], sensitivity.df[1,3], sensitivity.df[1,4], sensitivity.df[1,5])
method = c("LR", "CT", "KNN", "Ensemble", "Ensemble.prob")
both.df = data.frame(method, "accuracy"= acc, "sensitivity"=sens)
both.df$sum = both.df$accuracy + both.df$sensitivity
ggplot(data = both.df, aes(x = method, fill = accuracy + sensitivity)) + geom_bar(position="stack") + ggtitle("Methods overall comparison") + geom_text(aes(label = round(accuracy + sensitivity,4)), stat = "identity", colour = "grey38", size = 3, vjust = -0.3)
acc = c(accuracy.df[1,1], accuracy.df[1,2], accuracy.df[1,3], accuracy.df[1,4], accuracy.df[1,5])
sens = c(sensitivity.df[1,1], sensitivity.df[1,2], sensitivity.df[1,3], sensitivity.df[1,4], sensitivity.df[1,5])
method = c("LR", "CT", "KNN", "Ensemble", "Ensemble.prob")
both.df = data.frame(method, "accuracy"= acc, "sensitivity"=sens)
both.df$sum = both.df$accuracy + both.df$sensitivity
ggplot(data = both.df, aes(x = method, fill = accuracy + sensitivity, y = sum)) + geom_bar(position="stack") + ggtitle("Methods overall comparison") + geom_text(aes(label = round(accuracy + sensitivity,4)), stat = "identity", colour = "grey38", size = 3, vjust = -0.3)
acc = c(accuracy.df[1,1], accuracy.df[1,2], accuracy.df[1,3], accuracy.df[1,4], accuracy.df[1,5])
sens = c(sensitivity.df[1,1], sensitivity.df[1,2], sensitivity.df[1,3], sensitivity.df[1,4], sensitivity.df[1,5])
method = c("LR", "CT", "KNN", "Ensemble", "Ensemble.prob")
both.df = data.frame(method, "accuracy"= acc, "sensitivity"=sens)
both.df$sum = both.df$accuracy + both.df$sensitivity
ggplot(data = both.df, aes(x = method, fill = accuracy + sensitivity, y = sum)) + geom_bar(position="stack") + ggtitle("Methods overall comparison") + geom_text(aes(label = round(accuracy + sensitivity,4)), stat = "identity", colour = "grey38", size = 3, vjust = -0.3)
acc = c(accuracy.df[1,1], accuracy.df[1,2], accuracy.df[1,3], accuracy.df[1,4], accuracy.df[1,5])
sens = c(sensitivity.df[1,1], sensitivity.df[1,2], sensitivity.df[1,3], sensitivity.df[1,4], sensitivity.df[1,5])
method = c("LR", "CT", "KNN", "Ensemble", "Ensemble.prob")
both.df = data.frame(method, "accuracy"= acc, "sensitivity"=sens)
both.df$sum = both.df$accuracy + both.df$sensitivity
ggplot(data = both.df, aes(x = method, fill = accuracy + sensitivity, y = sum)) + geom_bar(position="stack") + ggtitle("Methods overall comparison") + geom_text(aes(label = round(accuracy + sensitivity,4)), stat = "count", colour = "grey38", size = 3, vjust = -0.3)
acc = c(accuracy.df[1,1], accuracy.df[1,2], accuracy.df[1,3], accuracy.df[1,4], accuracy.df[1,5])
sens = c(sensitivity.df[1,1], sensitivity.df[1,2], sensitivity.df[1,3], sensitivity.df[1,4], sensitivity.df[1,5])
method = c("LR", "CT", "KNN", "Ensemble", "Ensemble.prob")
both.df = data.frame(method, "accuracy"= acc, "sensitivity"=sens)
both.df$sum = both.df$accuracy + both.df$sensitivity
ggplot(data = both.df, aes(x = method, fill = accuracy + sensitivity)) + geom_bar(position="stack") + ggtitle("Methods overall comparison") + geom_text(aes(label = round(accuracy + sensitivity,4)), stat = "identity", colour = "grey38", size = 3, vjust = -0.3)
acc = c(accuracy.df[1,1], accuracy.df[1,2], accuracy.df[1,3], accuracy.df[1,4], accuracy.df[1,5])
sens = c(sensitivity.df[1,1], sensitivity.df[1,2], sensitivity.df[1,3], sensitivity.df[1,4], sensitivity.df[1,5])
method = c("LR", "CT", "KNN", "Ensemble", "Ensemble.prob")
both.df = data.frame(method, "accuracy"= acc, "sensitivity"=sens)
both.df$sum = both.df$accuracy + both.df$sensitivity
ggplot(data = both.df, aes(x = method, fill = accuracy + sensitivity)) + geom_bar(position="stack") + ggtitle("Methods overall comparison") + geom_text(aes(label = round(accuracy + sensitivity,4)), colour = "grey38", size = 3, vjust = -0.3)
acc = c(accuracy.df[1,1], accuracy.df[1,2], accuracy.df[1,3], accuracy.df[1,4], accuracy.df[1,5])
sens = c(sensitivity.df[1,1], sensitivity.df[1,2], sensitivity.df[1,3], sensitivity.df[1,4], sensitivity.df[1,5])
method = c("LR", "CT", "KNN", "Ensemble", "Ensemble.prob")
both.df = data.frame(method, "accuracy"= acc, "sensitivity"=sens)
both.df$sum = both.df$accuracy + both.df$sensitivity
ggplot(data = both.df, aes(x = method, fill = accuracy + sensitivity)) + geom_bar(position="stack") + ggtitle("Methods overall comparison") + geom_text(aes(label = round(accuracy + sensitivity,4)), stat = "count", colour = "grey38", size = 3, vjust = -0.3)
acc = c(accuracy.df[1,1], accuracy.df[1,2], accuracy.df[1,3], accuracy.df[1,4], accuracy.df[1,5])
sens = c(sensitivity.df[1,1], sensitivity.df[1,2], sensitivity.df[1,3], sensitivity.df[1,4], sensitivity.df[1,5])
method = c("LR", "CT", "KNN", "Ensemble", "Ensemble.prob")
both.df = data.frame(method, "accuracy"= acc, "sensitivity"=sens)
both.df$sum = both.df$accuracy + both.df$sensitivity
ggplot(data = both.df, aes(x = method, fill = accuracy + sensitivity)) + geom_bar(position="stack") + ggtitle("Methods overall comparison") + geom_text(aes(label = round(accuracy + sensitivity,4)), stat = both.df$sum, colour = "grey38", size = 3, vjust = -0.3)
acc = c(accuracy.df[1,1], accuracy.df[1,2], accuracy.df[1,3], accuracy.df[1,4], accuracy.df[1,5])
sens = c(sensitivity.df[1,1], sensitivity.df[1,2], sensitivity.df[1,3], sensitivity.df[1,4], sensitivity.df[1,5])
method = c("LR", "CT", "KNN", "Ensemble", "Ensemble.prob")
both.df = data.frame(method, "accuracy"= acc, "sensitivity"=sens)
both.df$sum = both.df$accuracy + both.df$sensitivity
ggplot(data = both.df, aes(x = method, fill = accuracy + sensitivity)) + geom_bar(position="stack") + ggtitle("Methods overall comparison") + geom_text(aes(label = round(accuracy + sensitivity,4)), stat = "count", colour = "grey38", size = 3, vjust = -0.3)
acc = c(accuracy.df[1,1], accuracy.df[1,2], accuracy.df[1,3], accuracy.df[1,4], accuracy.df[1,5])
sens = c(sensitivity.df[1,1], sensitivity.df[1,2], sensitivity.df[1,3], sensitivity.df[1,4], sensitivity.df[1,5])
method = c("LR", "CT", "KNN", "Ensemble", "Ensemble.prob")
both.df = data.frame(method, "accuracy"= acc, "sensitivity"=sens)
both.df$sum = both.df$accuracy + both.df$sensitivity
ggplot(data = both.df, aes(x = method, y = accuracy + sensitivity)) + geom_bar(position="stack") + ggtitle("Methods overall comparison") + geom_text(aes(label = round(accuracy + sensitivity,4)), stat = "count", colour = "grey38", size = 3, vjust = -0.3)
acc = c(accuracy.df[1,1], accuracy.df[1,2], accuracy.df[1,3], accuracy.df[1,4], accuracy.df[1,5])
sens = c(sensitivity.df[1,1], sensitivity.df[1,2], sensitivity.df[1,3], sensitivity.df[1,4], sensitivity.df[1,5])
method = c("LR", "CT", "KNN", "Ensemble", "Ensemble.prob")
both.df = data.frame(method, "accuracy"= acc, "sensitivity"=sens)
both.df$sum = both.df$accuracy + both.df$sensitivity
ggplot(data = both.df, aes(x = method, fill = accuracy + sensitivity)) + geom_bar(position="stack") + ggtitle("Methods overall comparison") + geom_text(aes(label = round(accuracy + sensitivity,4)), stat = "count", colour = "grey38", size = 3, vjust = -0.3)
acc = c(accuracy.df[1,1], accuracy.df[1,2], accuracy.df[1,3], accuracy.df[1,4], accuracy.df[1,5])
sens = c(sensitivity.df[1,1], sensitivity.df[1,2], sensitivity.df[1,3], sensitivity.df[1,4], sensitivity.df[1,5])
method = c("LR", "CT", "KNN", "Ensemble", "Ensemble.prob")
both.df = data.frame(method, "accuracy"= acc, "sensitivity"=sens)
both.df$sum = both.df$accuracy + both.df$sensitivity
barplot(method~sum, both.df)
acc = c(accuracy.df[1,1], accuracy.df[1,2], accuracy.df[1,3], accuracy.df[1,4], accuracy.df[1,5])
sens = c(sensitivity.df[1,1], sensitivity.df[1,2], sensitivity.df[1,3], sensitivity.df[1,4], sensitivity.df[1,5])
method = c("LR", "CT", "KNN", "Ensemble", "Ensemble.prob")
both.df = data.frame(method, "accuracy"= acc, "sensitivity"=sens)
both.df$sum = both.df$accuracy + both.df$sensitivity
barplot(sum ~ method, both.df)
acc = c(accuracy.df[1,1], accuracy.df[1,2], accuracy.df[1,3], accuracy.df[1,4], accuracy.df[1,5])
sens = c(sensitivity.df[1,1], sensitivity.df[1,2], sensitivity.df[1,3], sensitivity.df[1,4], sensitivity.df[1,5])
method = c("LR", "CT", "KNN", "Ensemble", "Ensemble.prob")
both.df = data.frame(method, "accuracy"= acc, "sensitivity"=sens)
both.df$sum = both.df$accuracy + both.df$sensitivity
barplot(sum ~ method, both.df)
ggplot(data = both.df, aes(x = method, fill = accuracy + sensitivity)) + geom_bar() + ggtitle("Methods overall comparison")
acc = c(accuracy.df[1,1], accuracy.df[1,2], accuracy.df[1,3], accuracy.df[1,4], accuracy.df[1,5])
sens = c(sensitivity.df[1,1], sensitivity.df[1,2], sensitivity.df[1,3], sensitivity.df[1,4], sensitivity.df[1,5])
method = c("LR", "CT", "KNN", "Ensemble", "Ensemble.prob")
both.df = data.frame(method, "accuracy"= acc, "sensitivity"=sens)
both.df$sum = both.df$accuracy + both.df$sensitivity
barplot(sum ~ method, both.df)
ggplot(data = both.df, aes(x = method, y = sum)) + geom_bar() + ggtitle("Methods overall comparison")
acc = c(accuracy.df[1,1], accuracy.df[1,2], accuracy.df[1,3], accuracy.df[1,4], accuracy.df[1,5])
sens = c(sensitivity.df[1,1], sensitivity.df[1,2], sensitivity.df[1,3], sensitivity.df[1,4], sensitivity.df[1,5])
method = c("LR", "CT", "KNN", "Ensemble", "Ensemble.prob")
both.df = data.frame(method, "accuracy"= acc, "sensitivity"=sens)
both.df$sum = both.df$accuracy + both.df$sensitivity
barplot(sum ~ method, both.df)
ggplot(data = both.df, aes(x = sum, y = method)) + geom_bar() + ggtitle("Methods overall comparison")
acc = c(accuracy.df[1,1], accuracy.df[1,2], accuracy.df[1,3], accuracy.df[1,4], accuracy.df[1,5])
sens = c(sensitivity.df[1,1], sensitivity.df[1,2], sensitivity.df[1,3], sensitivity.df[1,4], sensitivity.df[1,5])
method = c("LR", "CT", "KNN", "Ensemble", "Ensemble.prob")
both.df = data.frame(method, "accuracy"= acc, "sensitivity"=sens)
both.df$sum = both.df$accuracy + both.df$sensitivity
barplot(sum ~ method, both.df)
ggplot(data = both.df, aes(x = sum)) + geom_bar() + ggtitle("Methods overall comparison")
acc = c(accuracy.df[1,1], accuracy.df[1,2], accuracy.df[1,3], accuracy.df[1,4], accuracy.df[1,5])
sens = c(sensitivity.df[1,1], sensitivity.df[1,2], sensitivity.df[1,3], sensitivity.df[1,4], sensitivity.df[1,5])
method = c("LR", "CT", "KNN", "Ensemble", "Ensemble.prob")
both.df = data.frame(method, "accuracy"= acc, "sensitivity"=sens)
both.df$sum = both.df$accuracy + both.df$sensitivity
barplot(sum ~ method, both.df)
ggplot(data = both.df, aes(x = sum, fill = method)) + geom_bar() + ggtitle("Methods overall comparison")
acc = c(accuracy.df[1,1], accuracy.df[1,2], accuracy.df[1,3], accuracy.df[1,4], accuracy.df[1,5])
sens = c(sensitivity.df[1,1], sensitivity.df[1,2], sensitivity.df[1,3], sensitivity.df[1,4], sensitivity.df[1,5])
method = c("LR", "CT", "KNN", "Ensemble", "Ensemble.prob")
both.df = data.frame(method, "accuracy"= acc, "sensitivity"=sens)
both.df$sum = both.df$accuracy + both.df$sensitivity
barplot(sum ~ method, both.df)
ggplot(data = both.df, aes(x = method, y = sum)) + geom_bar() + ggtitle("Methods overall comparison")
acc = c(accuracy.df[1,1], accuracy.df[1,2], accuracy.df[1,3], accuracy.df[1,4], accuracy.df[1,5])
sens = c(sensitivity.df[1,1], sensitivity.df[1,2], sensitivity.df[1,3], sensitivity.df[1,4], sensitivity.df[1,5])
method = c("LR", "CT", "KNN", "Ensemble", "Ensemble.prob")
both.df = data.frame(method, "accuracy"= acc, "sensitivity"=sens)
both.df$sum = both.df$accuracy + both.df$sensitivity
barplot(sum ~ method, both.df, main = "Methods overall comparison", )
acc = c(accuracy.df[1,1], accuracy.df[1,2], accuracy.df[1,3], accuracy.df[1,4], accuracy.df[1,5])
sens = c(sensitivity.df[1,1], sensitivity.df[1,2], sensitivity.df[1,3], sensitivity.df[1,4], sensitivity.df[1,5])
method = c("LR", "CT", "KNN", "Ensemble", "Ensemble.prob")
both.df = data.frame(method, "accuracy"= acc, "sensitivity"=sens)
both.df$sum = both.df$accuracy + both.df$sensitivity
barplot(sum ~ method, both.df, main = "Methods overall comparison", ylab = "accuracy + sensitivity", las = 2)
acc = c(accuracy.df[1,1], accuracy.df[1,2], accuracy.df[1,3], accuracy.df[1,4], accuracy.df[1,5])
sens = c(sensitivity.df[1,1], sensitivity.df[1,2], sensitivity.df[1,3], sensitivity.df[1,4], sensitivity.df[1,5])
method = c("LR", "CT", "KNN", "Ensemble", "Ensemble.prob")
both.df = data.frame(method, "accuracy"= acc, "sensitivity"=sens)
both.df$sum = both.df$accuracy + both.df$sensitivity
barplot(sum ~ method, both.df, main = "Methods overall comparison", ylab = "accuracy + sensitivity", xlab = "", las = 2)
acc = c(accuracy.df[1,1], accuracy.df[1,2], accuracy.df[1,3], accuracy.df[1,4], accuracy.df[1,5])
sens = c(sensitivity.df[1,1], sensitivity.df[1,2], sensitivity.df[1,3], sensitivity.df[1,4], sensitivity.df[1,5])
method = c("LR", "CT", "KNN", "Ensemble", "Ensemble.prob")
both.df = data.frame(method, "accuracy"= acc, "sensitivity"=sens)
both.df$sum = both.df$accuracy + both.df$sensitivity
barplot(sum ~ method, both.df, main = "Methods overall comparison", ylab = "accuracy + sensitivity", xlab = "", las = 2, color = 1)
acc = c(accuracy.df[1,1], accuracy.df[1,2], accuracy.df[1,3], accuracy.df[1,4], accuracy.df[1,5])
sens = c(sensitivity.df[1,1], sensitivity.df[1,2], sensitivity.df[1,3], sensitivity.df[1,4], sensitivity.df[1,5])
method = c("LR", "CT", "KNN", "Ensemble", "Ensemble.prob")
both.df = data.frame(method, "accuracy"= acc, "sensitivity"=sens)
both.df$sum = both.df$accuracy + both.df$sensitivity
barplot(sum ~ method, both.df, main = "Methods overall comparison", ylab = "accuracy + sensitivity", xlab = "", las = 2, colour = 1)
acc = c(accuracy.df[1,1], accuracy.df[1,2], accuracy.df[1,3], accuracy.df[1,4], accuracy.df[1,5])
sens = c(sensitivity.df[1,1], sensitivity.df[1,2], sensitivity.df[1,3], sensitivity.df[1,4], sensitivity.df[1,5])
method = c("LR", "CT", "KNN", "Ensemble", "Ensemble.prob")
both.df = data.frame(method, "accuracy"= acc, "sensitivity"=sens)
both.df$sum = both.df$accuracy + both.df$sensitivity
barplot(sum ~ method, both.df, main = "Methods overall comparison", ylab = "accuracy + sensitivity", xlab = "", las = 2)
acc = c(accuracy.df[1,1], accuracy.df[1,2], accuracy.df[1,3], accuracy.df[1,4], accuracy.df[1,5])
sens = c(sensitivity.df[1,1], sensitivity.df[1,2], sensitivity.df[1,3], sensitivity.df[1,4], sensitivity.df[1,5])
method = c("LR", "CT", "KNN", "Ensemble", "Ensemble.prob")
both.df = data.frame(method, "accuracy"= acc, "sensitivity"=sens)
both.df$sum = both.df$accuracy + both.df$sensitivity
#barplot(sum ~ method, both.df, main = "Methods overall comparison", ylab = "accuracy + sensitivity", xlab = "", las = 2)
ggplot(data = both.df, aes(x = method, fill = accuracy + sensitivity)) + geom_bar(position="stack") + ggtitle("Methods overall comparison") + geom_text(aes(label = round(accuracy + sensitivity,4)), stat = "count", colour = "grey38", size = 3, vjust = -0.3)
acc = c(accuracy.df[1,1], accuracy.df[1,2], accuracy.df[1,3], accuracy.df[1,4], accuracy.df[1,5])
sens = c(sensitivity.df[1,1], sensitivity.df[1,2], sensitivity.df[1,3], sensitivity.df[1,4], sensitivity.df[1,5])
method = c("LR", "CT", "KNN", "Ensemble", "Ensemble.prob")
both.df = data.frame(method, "accuracy"= acc, "sensitivity"=sens)
both.df$sum = both.df$accuracy + both.df$sensitivity
#barplot(sum ~ method, both.df, main = "Methods overall comparison", ylab = "accuracy + sensitivity", xlab = "", las = 2)
ggplot(data = both.df, aes(x = method, fill = accuracy + sensitivity)) + geom_bar(position="stack") + ggtitle("Methods overall comparison") + geom_text(aes(label = round(accuracy + sensitivity,4)), stat = "count", colour = "grey38", size = 3, vjust = -0.3)
acc = c(accuracy.df[1,1], accuracy.df[1,2], accuracy.df[1,3], accuracy.df[1,4], accuracy.df[1,5])
sens = c(sensitivity.df[1,1], sensitivity.df[1,2], sensitivity.df[1,3], sensitivity.df[1,4], sensitivity.df[1,5])
method = c("LR", "CT", "KNN", "Ensemble", "Ensemble.prob")
both.df = data.frame(method, "accuracy"= acc, "sensitivity"=sens)
both.df$sum = both.df$accuracy + both.df$sensitivity
barplot(sum ~ method, both.df, main = "Methods overall comparison", ylab = "accuracy + sensitivity", xlab = "", las = 2)
ggplot(data = both.df, aes(x = method, fill = accuracy + sensitivity)) + geom_bar(position="stack") + ggtitle("Methods overall comparison") + geom_text(aes(label = round(accuracy + sensitivity,4)), stat = "count", colour = "grey38", size = 3, vjust = -0.3)
acc = c(accuracy.df[1,1], accuracy.df[1,2], accuracy.df[1,3], accuracy.df[1,4], accuracy.df[1,5])
sens = c(sensitivity.df[1,1], sensitivity.df[1,2], sensitivity.df[1,3], sensitivity.df[1,4], sensitivity.df[1,5])
method = c("LR", "CT", "KNN", "Ensemble", "Ensemble.prob")
both.df = data.frame(method, "accuracy"= acc, "sensitivity"=sens)
both.df$sum = both.df$accuracy + both.df$sensitivity
#barplot(sum ~ method, both.df, main = "Methods overall comparison", ylab = "accuracy + sensitivity", xlab = "", las = 2)
ggplot(data = both.df, aes(x = method, fill = accuracy + sensitivity, y = value)) + geom_bar(position="stack") + ggtitle("Methods overall comparison") + geom_text(aes(label = round(accuracy + sensitivity,4)), stat = "count", colour = "grey38", size = 3, vjust = -0.3)
acc = c(accuracy.df[1,1], accuracy.df[1,2], accuracy.df[1,3], accuracy.df[1,4], accuracy.df[1,5])
sens = c(sensitivity.df[1,1], sensitivity.df[1,2], sensitivity.df[1,3], sensitivity.df[1,4], sensitivity.df[1,5])
method = c("LR", "CT", "KNN", "Ensemble", "Ensemble.prob")
both.df = data.frame(method, "accuracy"= acc, "sensitivity"=sens)
both.df$sum = both.df$accuracy + both.df$sensitivity
#barplot(sum ~ method, both.df, main = "Methods overall comparison", ylab = "accuracy + sensitivity", xlab = "", las = 2)
ggplot(data = both.df, aes(x = method, fill = accuracy + sensitivity)) + geom_bar(position="stack") + ggtitle("Methods overall comparison") + geom_text(aes(label = round(accuracy + sensitivity,4)), stat = "count", colour = "grey38", size = 3, vjust = -0.3)
acc = c(accuracy.df[1,1], accuracy.df[1,2], accuracy.df[1,3], accuracy.df[1,4], accuracy.df[1,5])
sens = c(sensitivity.df[1,1], sensitivity.df[1,2], sensitivity.df[1,3], sensitivity.df[1,4], sensitivity.df[1,5])
method = c("LR", "CT", "KNN", "Ensemble", "Ensemble.prob")
both.df = data.frame(method, "accuracy"= acc, "sensitivity"=sens)
both.df$sum = both.df$accuracy + both.df$sensitivity
#barplot(sum ~ method, both.df, main = "Methods overall comparison", ylab = "accuracy + sensitivity", xlab = "", las = 2)
ggplot(data = both.df, aes(x = method, fill = accuracy + sensitivity)) + geom_bar(position="stack") + ggtitle("Methods overall comparison") + geom_text(aes(label = round(accuracy + sensitivity,4)), stat = "identity", colour = "grey38", size = 3, vjust = -0.3)
acc = c(accuracy.df[1,1], accuracy.df[1,2], accuracy.df[1,3], accuracy.df[1,4], accuracy.df[1,5])
sens = c(sensitivity.df[1,1], sensitivity.df[1,2], sensitivity.df[1,3], sensitivity.df[1,4], sensitivity.df[1,5])
method = c("LR", "CT", "KNN", "Ensemble", "Ensemble.prob")
both.df = data.frame(method, "accuracy"= acc, "sensitivity"=sens)
both.df$sum = both.df$accuracy + both.df$sensitivity
#barplot(sum ~ method, both.df, main = "Methods overall comparison", ylab = "accuracy + sensitivity", xlab = "", las = 2)
ggplot(data = both.df, aes(x = method, fill = accuracy + sensitivity)) + geom_bar(position="stack") + ggtitle("Methods overall comparison") + geom_text(aes(label = round(accuracy + sensitivity,4)), stat = "count", colour = "grey38", size = 3, vjust = -0.3)
View(accuracy.df.melt)
acc = c(accuracy.df[1,1], accuracy.df[1,2], accuracy.df[1,3], accuracy.df[1,4], accuracy.df[1,5])
sens = c(sensitivity.df[1,1], sensitivity.df[1,2], sensitivity.df[1,3], sensitivity.df[1,4], sensitivity.df[1,5])
method = c("LR", "CT", "KNN", "Ensemble", "Ensemble.prob")
both.df = data.frame(method, "accuracy"= acc, "sensitivity"=sens)
both.df$sum = both.df$accuracy + both.df$sensitivity
#barplot(sum ~ method, both.df, main = "Methods overall comparison", ylab = "accuracy + sensitivity", xlab = "", las = 2)
both.plot = ggplot(aes(x=reorder(method, sum), y=sum), data = both.df) + geom_col(fill="darkblue") + ylab("sum") + xlab("model") +
geom_text(aes(label = round(sum, 4)), vjust = -0.5) + theme_classic()
both.plot
acc = c(accuracy.df[1,1], accuracy.df[1,2], accuracy.df[1,3], accuracy.df[1,4], accuracy.df[1,5])
sens = c(sensitivity.df[1,1], sensitivity.df[1,2], sensitivity.df[1,3], sensitivity.df[1,4], sensitivity.df[1,5])
method = c("LR", "CT", "KNN", "Ensemble", "Ensemble.prob")
both.df = data.frame(method, "accuracy"= acc, "sensitivity"=sens)
both.df$sum = both.df$accuracy + both.df$sensitivity
#barplot(sum ~ method, both.df, main = "Methods overall comparison", ylab = "accuracy + sensitivity", xlab = "", las = 2)
both.plot = ggplot(aes(x=method, y=sum), data = both.df) + geom_col(fill="darkblue") + ylab("sum") + xlab("model") +
geom_text(aes(label = round(sum, 4)), vjust = -0.5) + theme_classic()
both.plot
acc = c(accuracy.df[1,1], accuracy.df[1,2], accuracy.df[1,3], accuracy.df[1,4], accuracy.df[1,5])
sens = c(sensitivity.df[1,1], sensitivity.df[1,2], sensitivity.df[1,3], sensitivity.df[1,4], sensitivity.df[1,5])
method = c("LR", "CT", "KNN", "Ensemble", "Ensemble.prob")
both.df = data.frame(method, "accuracy"= acc, "sensitivity"=sens)
both.df$sum = both.df$accuracy + both.df$sensitivity
#barplot(sum ~ method, both.df, main = "Methods overall comparison", ylab = "accuracy + sensitivity", xlab = "", las = 2)
both.plot = ggplot(aes(x=method, y=sum), data = both.df) + geom_col(fill="blue") + ylab("sum") + xlab("model") +
geom_text(aes(label = round(sum, 4)), vjust = -0.5) + theme_classic()
both.plot
acc = c(accuracy.df[1,1], accuracy.df[1,2], accuracy.df[1,3], accuracy.df[1,4], accuracy.df[1,5])
sens = c(sensitivity.df[1,1], sensitivity.df[1,2], sensitivity.df[1,3], sensitivity.df[1,4], sensitivity.df[1,5])
method = c("LR", "CT", "KNN", "Ensemble", "Ensemble.prob")
both.df = data.frame(method, "accuracy"= acc, "sensitivity"=sens)
both.df$sum = both.df$accuracy + both.df$sensitivity
#barplot(sum ~ method, both.df, main = "Methods overall comparison", ylab = "accuracy + sensitivity", xlab = "", las = 2)
both.plot = ggplot(aes(x=method, y=sum, color = method), data = both.df) + geom_col() + ylab("sum") + xlab("model") +
geom_text(aes(label = round(sum, 4)), vjust = -0.5) + theme_classic()
both.plot
acc = c(accuracy.df[1,1], accuracy.df[1,2], accuracy.df[1,3], accuracy.df[1,4], accuracy.df[1,5])
sens = c(sensitivity.df[1,1], sensitivity.df[1,2], sensitivity.df[1,3], sensitivity.df[1,4], sensitivity.df[1,5])
method = c("LR", "CT", "KNN", "Ensemble", "Ensemble.prob")
both.df = data.frame(method, "accuracy"= acc, "sensitivity"=sens)
both.df$sum = both.df$accuracy + both.df$sensitivity
#barplot(sum ~ method, both.df, main = "Methods overall comparison", ylab = "accuracy + sensitivity", xlab = "", las = 2)
both.plot = ggplot(aes(x=method, y=sum), data = both.df) + geom_col(color = method) + ylab("sum") + xlab("model") +
geom_text(aes(label = round(sum, 4)), vjust = -0.5) + theme_classic()
both.plot
acc = c(accuracy.df[1,1], accuracy.df[1,2], accuracy.df[1,3], accuracy.df[1,4], accuracy.df[1,5])
sens = c(sensitivity.df[1,1], sensitivity.df[1,2], sensitivity.df[1,3], sensitivity.df[1,4], sensitivity.df[1,5])
method = c("LR", "CT", "KNN", "Ensemble", "Ensemble.prob")
both.df = data.frame(method, "accuracy"= acc, "sensitivity"=sens)
both.df$sum = both.df$accuracy + both.df$sensitivity
#barplot(sum ~ method, both.df, main = "Methods overall comparison", ylab = "accuracy + sensitivity", xlab = "", las = 2)
both.plot = ggplot(aes(x=method, y=sum, colour = method), data = both.df) + geom_col() + ylab("sum") + xlab("model") +
geom_text(aes(label = round(sum, 4)), vjust = -0.5) + theme_classic()
both.plot
acc = c(accuracy.df[1,1], accuracy.df[1,2], accuracy.df[1,3], accuracy.df[1,4], accuracy.df[1,5])
sens = c(sensitivity.df[1,1], sensitivity.df[1,2], sensitivity.df[1,3], sensitivity.df[1,4], sensitivity.df[1,5])
method = c("LR", "CT", "KNN", "Ensemble", "Ensemble.prob")
both.df = data.frame(method, "accuracy"= acc, "sensitivity"=sens)
both.df$sum = both.df$accuracy + both.df$sensitivity
#barplot(sum ~ method, both.df, main = "Methods overall comparison", ylab = "accuracy + sensitivity", xlab = "", las = 2)
both.plot = ggplot(aes(x=method, y=sum), data = both.df) + geom_col() + ylab("sum") + xlab("model") +
geom_text(aes(label = round(sum, 4)), vjust = -0.5) + theme_classic()
both.plot
?geom_col
acc = c(accuracy.df[1,1], accuracy.df[1,2], accuracy.df[1,3], accuracy.df[1,4], accuracy.df[1,5])
sens = c(sensitivity.df[1,1], sensitivity.df[1,2], sensitivity.df[1,3], sensitivity.df[1,4], sensitivity.df[1,5])
method = c("LR", "CT", "KNN", "Ensemble", "Ensemble.prob")
both.df = data.frame(method, "accuracy"= acc, "sensitivity"=sens)
both.df$sum = both.df$accuracy + both.df$sensitivity
#barplot(sum ~ method, both.df, main = "Methods overall comparison", ylab = "accuracy + sensitivity", xlab = "", las = 2)
both.plot = ggplot(aes(x=method, y=sum), data = both.df) + geom_col(fill = method) + ylab("sum") + xlab("model") +
geom_text(aes(label = round(sum, 4)), vjust = -0.5) + theme_classic()
both.plot
acc = c(accuracy.df[1,1], accuracy.df[1,2], accuracy.df[1,3], accuracy.df[1,4], accuracy.df[1,5])
sens = c(sensitivity.df[1,1], sensitivity.df[1,2], sensitivity.df[1,3], sensitivity.df[1,4], sensitivity.df[1,5])
method = c("LR", "CT", "KNN", "Ensemble", "Ensemble.prob")
both.df = data.frame(method, "accuracy"= acc, "sensitivity"=sens)
both.df$sum = both.df$accuracy + both.df$sensitivity
#barplot(sum ~ method, both.df, main = "Methods overall comparison", ylab = "accuracy + sensitivity", xlab = "", las = 2)
both.plot = ggplot(aes(x=method, y=sum), data = both.df) + geom_col(fill = "blue") + ylab("sum") + xlab("model") +
geom_text(aes(label = round(sum, 4)), vjust = -0.5) + theme_classic()
both.plot
acc = c(accuracy.df[1,1], accuracy.df[1,2], accuracy.df[1,3], accuracy.df[1,4], accuracy.df[1,5])
sens = c(sensitivity.df[1,1], sensitivity.df[1,2], sensitivity.df[1,3], sensitivity.df[1,4], sensitivity.df[1,5])
method = c("LR", "CT", "KNN", "Ensemble", "Ensemble.prob")
both.df = data.frame(method, "accuracy"= acc, "sensitivity"=sens)
both.df$sum = both.df$accuracy + both.df$sensitivity
#barplot(sum ~ method, both.df, main = "Methods overall comparison", ylab = "accuracy + sensitivity", xlab = "", las = 2)
both.plot = ggplot(aes(x=method, y=sum), data = both.df) + geom_col(fill = "blue") + ylab("sum") + xlab("model") + ggtitle("Methods overall comparison") geom_text(aes(label = round(sum,4)), stat = "count", colour = "grey38", size = 3, vjust = -0.3) + theme_classic()
acc = c(accuracy.df[1,1], accuracy.df[1,2], accuracy.df[1,3], accuracy.df[1,4], accuracy.df[1,5])
sens = c(sensitivity.df[1,1], sensitivity.df[1,2], sensitivity.df[1,3], sensitivity.df[1,4], sensitivity.df[1,5])
method = c("LR", "CT", "KNN", "Ensemble", "Ensemble.prob")
both.df = data.frame(method, "accuracy"= acc, "sensitivity"=sens)
both.df$sum = both.df$accuracy + both.df$sensitivity
#barplot(sum ~ method, both.df, main = "Methods overall comparison", ylab = "accuracy + sensitivity", xlab = "", las = 2)
both.plot = ggplot(aes(x=method, y=sum), data = both.df) + geom_col(fill = "blue") + ylab("sum") + xlab("model") + ggtitle("Methods overall comparison") + geom_text(aes(label = round(sum,4)), stat = "count", colour = "grey38", size = 3, vjust = -0.3) + theme_classic()
both.plot
acc = c(accuracy.df[1,1], accuracy.df[1,2], accuracy.df[1,3], accuracy.df[1,4], accuracy.df[1,5])
sens = c(sensitivity.df[1,1], sensitivity.df[1,2], sensitivity.df[1,3], sensitivity.df[1,4], sensitivity.df[1,5])
method = c("LR", "CT", "KNN", "Ensemble", "Ensemble.prob")
both.df = data.frame(method, "accuracy"= acc, "sensitivity"=sens)
both.df$sum = both.df$accuracy + both.df$sensitivity
#barplot(sum ~ method, both.df, main = "Methods overall comparison", ylab = "accuracy + sensitivity", xlab = "", las = 2)
both.plot = ggplot(aes(x=method, y=sum), data = both.df) + geom_col(fill = "blue") + ylab("sum") + xlab("model") + ggtitle("Methods overall comparison") + geom_text(aes(label = round(sum,4)), colour = "grey38", size = 3, vjust = -0.3) + theme_classic()
both.plot
acc = c(accuracy.df[1,1], accuracy.df[1,2], accuracy.df[1,3], accuracy.df[1,4], accuracy.df[1,5])
sens = c(sensitivity.df[1,1], sensitivity.df[1,2], sensitivity.df[1,3], sensitivity.df[1,4], sensitivity.df[1,5])
method = c("LR", "CT", "KNN", "Ensemble", "Ensemble.prob")
both.df = data.frame(method, "accuracy"= acc, "sensitivity"=sens)
both.df$sum = both.df$accuracy + both.df$sensitivity
#barplot(sum ~ method, both.df, main = "Methods overall comparison", ylab = "accuracy + sensitivity", xlab = "", las = 2)
both.plot = ggplot(aes(x=method, y=sum), data = both.df) + geom_col(fill = "blue") + ylab("sum") + xlab("model") + ggtitle("Methods overall comparison") + geom_text(aes(label = round(sum,4)), colour = "grey38", size = 4, vjust = -0.3) + theme_classic()
both.plot
acc = c(accuracy.df[1,1], accuracy.df[1,2], accuracy.df[1,3], accuracy.df[1,4], accuracy.df[1,5])
sens = c(sensitivity.df[1,1], sensitivity.df[1,2], sensitivity.df[1,3], sensitivity.df[1,4], sensitivity.df[1,5])
method = c("LR", "CT", "KNN", "Ensemble", "Ensemble.prob")
both.df = data.frame(method, "accuracy"= acc, "sensitivity"=sens)
both.df$sum = both.df$accuracy + both.df$sensitivity
#barplot(sum ~ method, both.df, main = "Methods overall comparison", ylab = "accuracy + sensitivity", xlab = "", las = 2)
both.plot = ggplot(aes(x=method, y=sum), data = both.df) + geom_col(fill = "green") + ylab("sum") + xlab("model") + ggtitle("Methods overall comparison") + geom_text(aes(label = round(sum,4)), colour = "grey38", size = 4, vjust = -0.3) + theme_classic()
both.plot
acc = c(accuracy.df[1,1], accuracy.df[1,2], accuracy.df[1,3], accuracy.df[1,4], accuracy.df[1,5])
sens = c(sensitivity.df[1,1], sensitivity.df[1,2], sensitivity.df[1,3], sensitivity.df[1,4], sensitivity.df[1,5])
method = c("LR", "CT", "KNN", "Ensemble", "Ensemble.prob")
both.df = data.frame(method, "accuracy"= acc, "sensitivity"=sens)
both.df$sum = both.df$accuracy + both.df$sensitivity
#barplot(sum ~ method, both.df, main = "Methods overall comparison", ylab = "accuracy + sensitivity", xlab = "", las = 2)
both.plot = ggplot(aes(x=method, y=sum), data = both.df) + geom_col(fill = "darkgreen") + ylab("sum") + xlab("model") + ggtitle("Methods overall comparison") + geom_text(aes(label = round(sum,4)), colour = "grey38", size = 4, vjust = -0.3) + theme_classic()
both.plot
logit.reg$coefficients
View(logit.reg)
coef(summary(logit.reg))[,4]
c <- coef(summary(logit.reg))[,4]
View(c)
rm(c)
acc = c(accuracy.df[1,1], accuracy.df[1,2], accuracy.df[1,3], accuracy.df[1,4], accuracy.df[1,5])
sens = c(sensitivity.df[1,1], sensitivity.df[1,2], sensitivity.df[1,3], sensitivity.df[1,4], sensitivity.df[1,5])
method = c("LR", "CT", "KNN", "Ensemble", "Ensemble.prob")
both.df = data.frame(method, "accuracy"= acc, "sensitivity"=sens)
both.df$sum = both.df$accuracy + both.df$sensitivity
#barplot(sum ~ method, both.df, main = "Methods overall comparison", ylab = "accuracy + sensitivity", xlab = "", las = 2)
both.plot = ggplot(aes(x=method, y=accuracy+sensitivity), data = both.df) + geom_col(fill = "darkgreen") + ylab("sum") + xlab("model") + ggtitle("Methods overall comparison") + geom_text(aes(label = round(sum,4)), colour = "grey38", size = 4, vjust = -0.3) + theme_classic()
both.plot
# 1) Logistic Regression
logit.reg <- glm(stroke ~., data = train.lr, family = "binomial")
options(scipen = 999)
summary(logit.reg)
# 1) Reduced GLM
logit.reg2 <- glm(stroke ~ age + hypertension + avg_glucose_level, data = train.lr, family = "binomial")
options(scipen = 999)
summary(logit.reg2)
# Reduced GLM
logit.reg2 <- glm(stroke ~ age + hypertension + avg_glucose_level, data = train.lr, family = "binomial")
options(scipen = 999)
summary(logit.reg2)
set.seed(1)
pred.lr2 = predict(logit.reg2, valid.lr[,-18], type = "response")
# Confusion matrix with best cut-off (0.4):
conf.lr2 = confusionMatrix(as.factor(ifelse(pred.lr2 > cut_off.best, 1, 0)), valid.lr$stroke, positive = "1")
conf.lr2
fourfoldplot(confusionMatrix(as.factor(ifelse(pred.lr2 > cut_off.best, 1, 0)), valid.lr$stroke, positive = "1")$table)
fourfoldplot(confusionMatrix(as.factor(ifelse(pred.lr > cut_off.best, 1, 0)), valid.lr$stroke, positive = "1")$table)
# Find the best cut-off:
cut_off2 = seq(0.01,0.99,0.01)
metrics.lr2 <- data.frame(cut_off2, sensitivity = rep(0, length(cut_off2)), accuracy = rep(0, length(cut_off2)))
for (i in 1:length(cut_off2)){
x <- as.factor(ifelse(pred.lr2 >= cut_off2[i],1,0))
metrics.lr2[i, 2] <- confusionMatrix(x, valid.lr$stroke, positive = "1")$byClass[1]
metrics.lr2[i, 3] <- confusionMatrix(x, valid.lr$stroke, positive = "1")$overall[1]
}
cutoff.plot2 = ggplot(data= metrics.lr2) + geom_line(aes(x=cut_off2,y=sensitivity, color="Sensitivity")) + geom_line(aes(x=cut_off2,y=accuracy, color = "Accuracy")) + geom_vline(xintercept = 0.0484 , linetype="dashed") + theme_classic() + ggtitle("Sensitivity and Accuracy cut-off")
cutoff.plot2
metrics.lr2$difference = sqrt((metrics.lr2$accuracy - metrics.lr2$sensitivity)^2)
cut_off.best2 = cut_off2[which.min(metrics.lr2$difference)]
cut_off.best2
set.seed(1)
# 1) Logistic Regression
logit.reg <- glm(stroke ~., data = train.lr, family = "binomial")
options(scipen = 999)
summary(logit.reg)
set.seed(1)
# Reduced GLM
logit.reg2 <- glm(stroke ~ age + hypertension + avg_glucose_level, data = train.lr, family = "binomial")
options(scipen = 999)
summary(logit.reg2)
pred.lr2 = predict(logit.reg2, valid.lr[,-18], type = "response")
# Confusion matrix with best cut-off (0.4):
conf.lr2 = confusionMatrix(as.factor(ifelse(pred.lr2 > cut_off.best, 1, 0)), valid.lr$stroke, positive = "1")
conf.lr2
fourfoldplot(confusionMatrix(as.factor(ifelse(pred.lr2 > cut_off.best, 1, 0)), valid.lr$stroke, positive = "1")$table)
set.seed(1)
# Reduced GLM
logit.reg2 <- glm(stroke ~ age + hypertension + avg_glucose_level, data = train.lr, family = "binomial")
options(scipen = 999)
summary(logit.reg2)
pred.lr2 = predict(logit.reg2, valid.lr[,-18], type = "response")
# Confusion matrix with best cut-off (0.4):
conf.lr2 = confusionMatrix(as.factor(ifelse(pred.lr2 > cut_off.best, 1, 0)), valid.lr$stroke, positive = "1")
conf.lr2
fourfoldplot(confusionMatrix(as.factor(ifelse(pred.lr2 > cut_off.best, 1, 0)), valid.lr$stroke, positive = "1")$table, color = c("#CC6666", "#99CC99"))
### Creating the confusion Matrix --> need just to change the K = 1 & the 21 corresponds to the stroke variable.
pred.knn = knn(train.norm.knn[, -20], valid.norm.knn[, -20], cl = train.norm.knn[, 20], k = k.best, prob = T)
## k.best = 1:
conf.knn = confusionMatrix(pred.knn, valid.norm.knn[, 20], positive = "1")
conf.knn
fourfoldplot(confusionMatrix(pred.knn, valid.norm.knn[, 20], positive = "1")$table, color = c("#CC6666", "#99CC99"))
# Confusion matrix for CT:
conf.ct = confusionMatrix(pred.best.pruned, valid.ct$stroke, positive = "1")
conf.ct
fourfoldplot(confusionMatrix(pred.best.pruned, valid.ct$stroke, positive = "1")$table, color = c("#CC6666", "#99CC99"))
# Prediction on the training set itself:
#confusionMatrix(predict(best.pruned, train.ct, type = "class", parms = list(prior= c(ratio_0, ratio_1))), train.ct$stroke, positive = "1")
# Confusion matrix with best cut-off (0.4):
conf.lr = confusionMatrix(as.factor(ifelse(pred.lr > cut_off.best, 1, 0)), valid.lr$stroke, positive = "1")
conf.lr
fourfoldplot(confusionMatrix(as.factor(ifelse(pred.lr > cut_off.best, 1, 0)), valid.lr$stroke, positive = "1")$table, color = c("#CC6666", "#99CC99"))
# Confusion matrix with cut-off 0.5:
set.seed(1)
pred.lr = predict(logit.reg, valid.lr[,-18], type = "response")
confusionMatrix(as.factor(ifelse(pred.lr > 0.5, 1, 0)), valid.lr$stroke, positive = "1")
fourfoldplot(confusionMatrix(as.factor(ifelse(pred.lr > 0.5, 1, 0)), valid.lr$stroke, positive = "1")$table, color = c("#CC6666", "#99CC99"))
set.seed(1)
# Reduced GLM
logit.reg2 <- glm(stroke ~ age + hypertension + avg_glucose_level + heart_disease, data = train.lr, family = "binomial")
options(scipen = 999)
summary(logit.reg2)
pred.lr2 = predict(logit.reg2, valid.lr[,-18], type = "response")
# Confusion matrix with best cut-off (0.4):
conf.lr2 = confusionMatrix(as.factor(ifelse(pred.lr2 > cut_off.best, 1, 0)), valid.lr$stroke, positive = "1")
conf.lr2
fourfoldplot(confusionMatrix(as.factor(ifelse(pred.lr2 > cut_off.best, 1, 0)), valid.lr$stroke, positive = "1")$table, color = c("#CC6666", "#99CC99"))
set.seed(1)
# Reduced GLM
logit.reg2 <- glm(stroke ~ age + hypertension + avg_glucose_level + work_type, data = train.lr, family = "binomial")
options(scipen = 999)
summary(logit.reg2)
pred.lr2 = predict(logit.reg2, valid.lr[,-18], type = "response")
# Confusion matrix with best cut-off (0.4):
conf.lr2 = confusionMatrix(as.factor(ifelse(pred.lr2 > cut_off.best, 1, 0)), valid.lr$stroke, positive = "1")
conf.lr2
fourfoldplot(confusionMatrix(as.factor(ifelse(pred.lr2 > cut_off.best, 1, 0)), valid.lr$stroke, positive = "1")$table, color = c("#CC6666", "#99CC99"))
0.7578 +0.75532
set.seed(1)
# Reduced GLM
logit.reg2 <- glm(stroke ~ age + hypertension + avg_glucose_level, data = train.lr, family = "binomial")
options(scipen = 999)
summary(logit.reg2)
pred.lr2 = predict(logit.reg2, valid.lr[,-18], type = "response")
# Confusion matrix with best cut-off (0.4):
conf.lr2 = confusionMatrix(as.factor(ifelse(pred.lr2 > cut_off.best, 1, 0)), valid.lr$stroke, positive = "1")
conf.lr2
fourfoldplot(confusionMatrix(as.factor(ifelse(pred.lr2 > cut_off.best, 1, 0)), valid.lr$stroke, positive = "1")$table, color = c("#CC6666", "#99CC99"))
0.7578 +0.75532
0.748 + 0.76596
set.seed(1)
# Reduced GLM
logit.reg2 <- glm(stroke ~ age + hypertension + avg_glucose_level, data = train.lr, family = "binomial")
options(scipen = 999)
summary(logit.reg2)
pred.lr2 = predict(logit.reg2, valid.lr[,-18], type = "response")
# Confusion matrix with best cut-off (0.4):
conf.lr2 = confusionMatrix(as.factor(ifelse(pred.lr2 > cut_off.best, 1, 0)), valid.lr$stroke, positive = "1")
conf.lr2
fourfoldplot(confusionMatrix(as.factor(ifelse(pred.lr2 > cut_off.best, 1, 0)), valid.lr$stroke, positive = "1")$table, color = c("#CC6666", "#99CC99"))
lr.plots = data.frame("LR"= both.df$sum[1,4], "LR.reduced"= conf.lr2$overall[1]+conf.lr2$byClass[1])
both.df$sum[1,4]
set.seed(1)
# Reduced GLM
logit.reg2 <- glm(stroke ~ age + hypertension + avg_glucose_level, data = train.lr, family = "binomial")
options(scipen = 999)
summary(logit.reg2)
pred.lr2 = predict(logit.reg2, valid.lr[,-18], type = "response")
# Confusion matrix with best cut-off (0.4):
conf.lr2 = confusionMatrix(as.factor(ifelse(pred.lr2 > cut_off.best, 1, 0)), valid.lr$stroke, positive = "1")
conf.lr2
fourfoldplot(confusionMatrix(as.factor(ifelse(pred.lr2 > cut_off.best, 1, 0)), valid.lr$stroke, positive = "1")$table, color = c("#CC6666", "#99CC99"))
lr.plots = data.frame("LR"= both.df[1,4], "LR.reduced"= conf.lr2$overall[1]+conf.lr2$byClass[1])
View(lr.plots)
set.seed(1)
# Reduced GLM
logit.reg2 <- glm(stroke ~ age + hypertension + avg_glucose_level, data = train.lr, family = "binomial")
options(scipen = 999)
summary(logit.reg2)
pred.lr2 = predict(logit.reg2, valid.lr[,-18], type = "response")
# Confusion matrix with best cut-off (0.4):
conf.lr2 = confusionMatrix(as.factor(ifelse(pred.lr2 > cut_off.best, 1, 0)), valid.lr$stroke, positive = "1")
conf.lr2
fourfoldplot(confusionMatrix(as.factor(ifelse(pred.lr2 > cut_off.best, 1, 0)), valid.lr$stroke, positive = "1")$table, color = c("#CC6666", "#99CC99"))
lr.plots = data.frame("LR"= both.df[1,4], "LR.reduced"= conf.lr2$overall[1]+conf.lr2$byClass[1])
